<!DOCTYPE html>
<html>
    <head>
    <title>My Website</title>
    </head>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-WJ6X1G3H37"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
    
        gtag('config', 'G-4VSP05K4M4s');
    </script>

    <body>

        <style>
            #Title {
                background-color: orange;
            }
            #profileTable {
                width: 100%;
                border-collapse: collapse;
            }
        </style>

    <h1 id="Title">Profile App <img src="https://github.com/PaulP1514/PaulP1514/blob/main/paulgram-high-resolution-logo.png?raw=true" alt="Paulgram Logo" width="100" height="70"></h1>

    <iframe src="https://thunkable.site/w/khsBuhqOQr4rmnaIE3hh9" title="Profile App" height="725" width="425" style="display: block; margin: 0 auto; "></iframe>

    <hr style="margin-top: 2em;">
    <h2 style="text-align: center;">Profiles</h2>
    
    <table id="profileTable">
        <thead>
            <tr>
                <th> Name </th>
                <th> Birthday </th>
                <th> Major </th>
                <th> Year  </th>
                <th> Photo </th>
            </tr>
        </thead>
        <tbody>
    
        </tbody>
    </table>

    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "firebase/app";
        import { getAnalytics } from "firebase/analytics";
        // TODO: Add SDKs for Firebase products that you want to use
        // https://firebase.google.com/docs/web/setup#available-libraries

        // Your web app's Firebase configuration
        // For Firebase JS SDK v7.20.0 and later, measurementId is optional
        const firebaseConfig = {
        apiKey: "AIzaSyArHR6WNCH-kKsVOXWyNaYUxhLp0q6Yr8E",
        authDomain: "project-app-ef9c6.firebaseapp.com",
        databaseURL: "https://project-app-ef9c6-default-rtdb.firebaseio.com",
        projectId: "project-app-ef9c6",
        storageBucket: "project-app-ef9c6.appspot.com",
        messagingSenderId: "950456500176",
        appId: "1:950456500176:web:4df0b9a7641f44df4fc3d5",
        measurementId: "G-4VSP05K4M4"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);

        import {getDatabase, ref, get, set, child, update, remove}
        from "https://www.gstatic.com/firebasejs/10.8.0/firebase-database.js";
        
        const db = getDatabase();

        function displayData() {
            const dbref = ref(db);
            get(dbref)
            .then((snapshot)=>{
                if(snapshot.exists()){
                    const data = snapshot.val();
                    const profileTableBody = document.getElementById("profileTable");
                    profileTableBody.innerHTML = "";
                    Object.keys(data).forEach(key => {
                        const person = data[key];
                        const row = document.createElement("tr");
                        row.innerHTML = `
                            <td>${person.name}</td>
                            <td>${person.birthday}</td>
                            <td><img src="${person.image}" alt="Picture" style="max-width: 100px;"></td>
                            <td>${person.major}</td>
                            <td>${person.year}</td>
                        `;
                        profileTableBody.appendChild(row);
                    });
                } else {
                    alert("No data found");
                }
            })
            .catch((error)=>{
                alert(error)
            })
        }
        displayData();
    </script>
    </body>
</html>
